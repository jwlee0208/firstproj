<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
    <mapper namespace="sql.user">
        <insert id="insertUserInfo" parameterType="user.userDto"> 
			INSERT INTO TB_USER
				(user_id,
				user_nm,
				passwd,
				email,
				phone_no,
			<if test="nationality != null and nationality != ''">
				nationality,
			</if>
			<if test="language != null and language != ''">
				language,
			</if>	
				join_date)
			VALUES
				(#{userId},
				#{userNm},
				#{passwd},
				#{email},
				#{phoneNo},
			<if test="nationality != null and nationality != ''">
				LOWER(#{nationality}),
			</if>	
			<if test="language != null and language != ''">
				LOWER(#{language}),
			</if>	
				CURRENT_TIMESTAMP())
<!-- 			WHERE user_id != #{userId}	 -->
			
        </insert>
        <select id="selectUserList" parameterType="user.userDto" resultType="user.userDto">
        </select>
		
		<select id="selectUserInfo" parameterType="user.userDto" resultType="user.userDto">
		    SELECT 
		    	user_id, 
		    	user_nm,
		    	passwd,
		    	email,
		    	phone_no,
		    	nationality,
		    	language,
		    	join_date 
		    FROM TB_USER
		    WHERE user_id = #{userId}
		</select>
		
		<update id="updateUserInfo" parameterType="user.userDto">
			UPDATE TB_USER 
			   SET user_nm  = #{userNm}
			     , email    = #{email}
			     , phone_no = #{phoneNo}
			     , nationality = LOWER(#{nationality})
			     , language    = LOWER(#{language})
			WHERE user_id = #{userId}     
		</update>
		
    </mapper>